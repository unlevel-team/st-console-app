<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-list/iron-list.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">


<link rel="import" href="../bower_components/paper-styles/color.html">
<link rel="import" href="../bower_components/paper-styles/default-theme.html">
<link rel="import" href="../bower_components/paper-styles/shadow.html">

<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">



<dom-module id="st-view-EnginesList">

  <template>

    <style>
      :host {
        display: block;
        padding: 10px;
      }
      .card {
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);
        padding: 16px;
        margin: 24px;
        border-radius: 5px;
        background-color: #fff;
        color: #757575;
      }
      .circle {
        display: inline-block;
        height: 64px;
        width: 64px;
        border-radius: 50%;
        background: #ddd;
        line-height: 64px;
        font-size: 30px;
        color: #555;
        text-align: center;
      }
      h1 {
        font-size: 22px;
        margin: 16px 0;
        color: #212121;
      }
      
      h2 {
        font-size: 19px;
        margin: 16px 0;
      }
      
      iron-list {
        padding-top: 11px;
        --iron-list-items-container: {
          max-width: 800px;
          margin: auto;
          margin-top: 11px;
          margin-bottom: 60px;
          border-bottom: 1px solid #ddd;
        };
      }

      .item {
        @apply(--layout-horizontal);
        padding: 20px;
        background-color: white;
        border: 1px solid #ddd;
        cursor: pointer;
        margin-bottom: 10px;
      }

      .avatar {
        height: 40px;
        width: 40px;
        border-radius: 20px;
        box-sizing: border-box;
        background-color: #DDD;
      }

      .pad {
        padding: 0 16px;
        @apply(--layout-flex);
        @apply(--layout-vertical);
      }

      .primary {
        font-size: 16px;
        font-weight: bold;
      }

      .shortText, .longText {
        font-size: 14px;
      }

      .longText {
        color: gray;
        display: none;
      }

      .item:hover .shortText::after {
        content: ' [+]';
        color: gray;
      }

      .item.expanded:hover .shortText::after {
        content: '';
      }

      .item.expanded .longText {
        display: block;
      }

      .item.expanded:hover .longText::after {
        content: ' [ - ]';
      }

      .spacer {
        @apply(--layout-flex);
      }
      
      #toast_Error {
	    --paper-toast-background-color: red;
	    --paper-toast-color: white;
	  }
	  
	  #engineOptions_Dialog {
	  	top: 110px;
	  }
      
      .elementHidden {
      	display: none;
      }
      
      
      
    </style>

    <div class="card">
<!--       <div class="circle">1</div> -->
      <h1>Engines</h1>
      
	<p>The ST Engines is the part of the 'ST system' that defines the interactions with real world using specific devices like sensors or actuators.</p>
	<p>The 'ST Engines' are used by 'ST Nodes' and managed by 'ST Server' using 'ST.Network'.</p>

	<h2>Sensors list</h2>
	<p id="list_SensorsHeader">
		<paper-button raised 
			on-tap="_enginesList"
			data-type="sensor">
			get Sensors List
		</paper-button>
	</p>
	<iron-list id="listForSensors" items="[[sensors]]" as="item" selection-enabled multi-selection>
      <template>
        <div>
          <div class$="[[getClassForItem(item, selected)]]" tabindex$="[[tabIndex]]">
            <iron-image class="avatar" sizing="contain" src="[[item.image]]"><h2> &nbsp;&nbsp; S </h2></iron-image>
<!--             <iron-icon icon$="[[iconForItem(item)]]"></iron-icon> -->
            
            <div class="pad" on-tap="_updateLists">
              <div class="primary">[[item._sysID]]</div>
              <div class="shortText"><b>state:</b> [[item.state]]</div>
              <div class="longText">
              
              	<div class="shortText"><b>type:</b> [[item.type]]</div>
              	<div class="shortText"><b>engine:</b> [[item.engine]]</div>
              	
   	           	<div class="shortText">
	              	<paper-button raised 
	              		on-tap="_engineSettings" 
	              		data-type="sensor"
	              		data-engineid$="[[item._sysID]]">
	              		settings
	              		<iron-icon icon="settings"></iron-icon>  	
	              	</paper-button>
	              	<paper-button raised on-tap="_engineRun" 
	              		class$="[[getClassForButton(item, 'start')]]"
	              		data-type="sensor" 
	              		data-command="start"
	              		data-engineid$="[[item._sysID]]">
	              	run
	              	<iron-icon icon=play-arrow></iron-icon>  	
           			</paper-button>
              		<paper-button raised on-tap="_engineRun" 
              			class$="[[getClassForButton(item, 'stop')]]"
	              		data-type="sensor" 
	              		data-command="stop"
	              		data-engineid$="[[item._sysID]]">
	              	run
	              	<iron-icon icon=stop></iron-icon>  	
           			</paper-button>
              	</div>
              
              </div>
            </div>
            
            <iron-icon icon$="[[iconForItem(item)]]"></iron-icon>
          </div>
        </div>
      </template>
    </iron-list>


	<h2>Actuators list</h2>
	<p id="list_ActuatorsHeader">
		<paper-button raised 
			on-tap="_enginesList"
			data-type="actuator">
			get Actuators List
			</paper-button>
	</p>
    <iron-list id="listForActuators" 
    	items="[[actuators]]" as="item" 
    	selection-enabled multi-selection
    	scroll-target="document">
      <template>
        <div>
          <div class$="[[getClassForItem(item, selected)]]" tabindex$="[[tabIndex]]">
            <iron-image class="avatar" sizing="contain" src="[[item.image]]"><h2> &nbsp;&nbsp; A </h2></iron-image>
            <div class="pad" on-tap="_updateLists">
              <div class="primary">[[item._sysID]]</div>
              <div class="shortText"><b>state:</b> [[item.state]]</div>
              <div class="longText">
              
                <div class="shortText"><b>type:</b> [[item.type]]</div>
              	<div class="shortText"><b>engine:</b> [[item.engine]]</div>
              
              	<paper-button raised 
              			on-click="_engineSettings" 
	              		data-type="actuator" 
	              		data-engineid$="[[item._sysID]]">
	              	settings
	              	<iron-icon icon="settings"></iron-icon>  	
              	</paper-button>
              	<paper-button raised on-click="_engineRun" 
	              		data-type="actuator" 
	              		data-command="start"
	              		data-engine$="[[item]]"
	              		data-engineid$="[[item._sysID]]"
	              		class$="[[getClassForButton(item, 'start')]]">
	              	run
	              	<iron-icon icon=play-arrow></iron-icon>  	
           		</paper-button>
           		<paper-button raised on-tap="_engineRun" 
              			class$="[[getClassForButton(item, 'stop')]]"
	              		data-type="actuator" 
	              		data-command="stop"
	              		data-engineid$="[[item._sysID]]">
	              	stop
	              	<iron-icon icon=stop></iron-icon>  	
           		</paper-button>
              </div>
            </div>
            <iron-icon icon$="[[iconForItem(item)]]"></iron-icon>
          </div>
        </div>
      </template>
    </iron-list>
    
    
<!--  Toast objects -->
    <paper-toast id="toast_Error" 
    	text="[[toast_ErrorMessage]]"></paper-toast>
	<paper-toast id="toast_OK" 
		text="[[toast_Message]]"></paper-toast>
    </div>


<!--  Engine options dialog -->
	<paper-dialog id="engineOptions_Dialog" role="dialog" tabindex="-1"
		aria-hidden="true" class="x-scope paper-dialog-0"
		style="outline: none; display: none;">
	
	
	<h2>Engine settings</h2>
		<div class="card">
<!-- 		<form is="iron-form" id="engineOptions_Form"> -->
	
			<p><b>type:</b> {{selectedEngine.type}}</p>
			<p><b>ID:</b> {{selectedEngine.engine._sysID}}</p>
			<p><b>engine:</b> {{selectedEngine.engine.engine}}</p>
			
			
	
<!-- 			<paper-input name="netLocation" label="Net location" -->
<!-- 				placeholder="[[netLocation]]" value="[[netLocation]]" required -->
<!-- 				auto-validate></paper-input> -->
<!-- 		</form> -->
		</div>
	
	<p>Every engine has it's own options. Could be changed when the engine is no working</p>
		
	
		
	<div class="card">
			<br>
			<paper-button raised role="button" tabindex="0" animated=""
				aria-disabled="false" elevation="0" class="x-scope paper-button-0"
				on-click="_getEngineOptions">
			Get options</paper-button>
			
			<br><br>
	</div>
		
	<div class="buttons">
		<paper-button role="button" tabindex="0" animated=""
			aria-disabled="false" elevation="0" class="x-scope paper-button-0">More
		Info...</paper-button>
		<paper-button dialog-dismiss="" role="button" tabindex="0" animated=""
			aria-disabled="false" elevation="0" class="x-scope paper-button-0">Decline</paper-button>
		<paper-button dialog-confirm="" autofocus="" role="button" tabindex="0"
			animated="" aria-disabled="false" elevation="0"
			class="x-scope paper-button-0">Accept</paper-button>
	</div>
	
	</paper-dialog> 


  </template>
  
  
  

  <script>
			Polymer({

				is: 'st-view-EnginesList',

				sensors: {
					type : Array,
					notify: true
				},

				actuators: {
					type : Array,
					notify: true
				},

				toast_ErrorMessage: String,
				toast_Message: String,
				
// 				selectedEngine : {
// 					type : Object
// 				},

				properties: {
					selectedEngine: {
			          type: Object,
			          value: function() {
			            return {
			            	'type':'eee',
			            	'engineid':'eee',
			            	'engine': {}
			            };
			          }
			        }
			    },
			      
			      
			    observers: [
                  	'engineChanged(sensors.*)',
                  	'engineChanged(actuators.*)'
                ],
                engineChanged: function(changeRecord) {
                	console.log('path: ' + changeRecord.path);	// TODO REMOVE DEBUG LOG
			        console.log('value: ' + changeRecord.value);	// TODO REMOVE DEBUG LOG
			        console.log(changeRecord.value);	// TODO REMOVE DEBUG LOG
                },

				ready: function() {

					var _view = this;
					var _consoleApp = st_ConsoleApp.get_ConsoleApp();
					var _engineOptions_Dialog = _view.$.engineOptions_Dialog;

					_engineOptions_Dialog.fitInto = _view;
					_engineOptions_Dialog.refit()

					// Map event 'configChanged'
					_consoleApp.domEvents
							.addEventListener(
									'configChanged',
									function(event) {

										console.log("st-view-EnginesList.configChanged"); // TODO REMOVE DEBUG LOG
										console.log(event); // TODO REMOVE DEBUG LOG
										
										_view.sensors = [];
										_view.actuators = [];

									});
					
					

					_view._init_Toast();
				},

				_init_Toast: function() {

					var _view = this;
					var _toast_Error = _view.$.toast_Error;
					var _toast_OK = _view.$.toast_OK;

					_view.toast_ErrorMessage = "";
					_view.toast_Message = "";

				},

				attached: function() {
					// Use the document element
// 					this.$.listForSensors.scrollTarget = this.ownerDocument.documentElement;
// 					this.$.listForActuators.scrollTarget = this.ownerDocument.documentElement;
					
					// Use the document element
// 					this.$.listForSensors.scrollTarget = this.$.listForSensors_Container;
// 					this.$.listForActuators.scrollTarget = this;

				},

				iconForItem: function(item) {
					//         return item ? (item.integer < 50 ? 'star-border' : 'star') : '';
					return 'star';
				},

				getClassForItem: function(item, selected) {
					
					return selected ? 'item expanded' : 'item';
				},
				
				getClassForButton: function(item, button) {
					
					switch (button) {
						case 'start':
							return (item.state === 'config' || item.state === 'ready') ? '' : 'elementHidden';
							
						case 'stop':
							return (item.state === 'working') ? '' : 'elementHidden';
	
						default:
							return '';
					}
					
				},
				
				
				_updateLists: function() {
					
					console.log("_updateLists"); // TODO REMOVE DEBUG LOG

					// this.$.listForSensors.render();
					this.$.listForSensors.fire('iron-resize');
					this.$.listForActuators.fire('iron-resize');
					

				},	
				
				
				_enginesList: function(e, detail) {
					
					console.log("_enginesList"); // TODO REMOVE DEBUG LOG

					var _consoleApp = st_ConsoleApp.get_ConsoleApp();
					var _view = this;
					
					var _button = Polymer.dom(e).localTarget;
					var _buttonDataSet = _button.dataset;
					
					var _type = _buttonDataSet.type;
					
					var _toast_Error = _view.$.toast_Error;
					var _toast_OK = _view.$.toast_OK;
					
					var _toastRef = null;
					var _scs_Request = null;
					var _scs_RequestOptions = null;
					
					switch (_type) {
						case 'sensor':
							_scs_Request = st_ConsoleApp.engines.sensors.get_SensorsList;
							_toastRef = _view.$.list_SensorsHeader;
							break;
							
						case 'actuator':
							_scs_Request = st_ConsoleApp.engines.actuators.get_ActuatorsList;
							_toastRef = _view.$.list_ActuatorsHeader;
							break;
	
						default:
							break;
					}
					
					if (_scs_Request === null) {
						return;
					}
					
					try {
						
						_scs_RequestOptions = {
								"consoleApp" : _consoleApp
						};

						_scs_Request(_scs_RequestOptions)
								.then(function(data) {

										console.log("st-view-EnginesList._enginesList - then..."); // TODO REMOVE DEBUG LOG
										console.log(data); // TODO REMOVE DEBUG LOG
										
										var _numOfEngines = 0;
										switch (_type) {
											case 'sensor':
												_view.sensors = data.sensors;
												_numOfEngines = data.numberOfSensors;
												break;
											case 'actuator':
												_view.actuators = data.actuators;
												_numOfEngines = data.numberOfActuators;
												break;
	
											default:
												break;
										}
										

										// Show toast message
										_toast_OK.close();
										_view.toast_Message = "Engines list updated... ("
												+ _numOfEngines
												+ ")";
										_toast_OK.fitInto = _toastRef;
										_toast_OK.open();

									},
									function(error) {

									// Show toast message
									_toast_OK.close();
									_view.toast_ErrorMessage = "Cannot get Engines list";
									_toast_Error.fitInto = _toastRef;
									_toast_Error.open();

									console.log("st-view-EnginesList._enginesList - error..."); // TODO REMOVE DEBUG LOG
									console.log(error); // TODO REMOVE DEBUG LOG
								});

					} catch (e) {
						// TODO: handle exception
						console.log("Error in Engines List"); // TODO REMOVE DEBUG LOG
						console.log(e); // TODO REMOVE DEBUG LOG
					}

					
					
				},	// enfOf _enginesList
				
				
				_engineSettings: function(e, detail) {

					console.log("_engineSettings"); // TODO REMOVE DEBUG LOG
					
					var _consoleApp = st_ConsoleApp.get_ConsoleApp();
					var _view = this;
					var _engineOptions_Dialog = _view.$.engineOptions_Dialog;
					
					var _selectedEngine = _view.get('selectedEngine');
					var _button = Polymer.dom(e).localTarget;
					var _buttonDataSet = _button.dataset;
					
					var _ngnList = null;

					_selectedEngine.type = _buttonDataSet.type;
					_selectedEngine.engineid = _buttonDataSet.engineid;
					// _selectedEngine.engine = JSON.parse(_buttonDataSet.engine);
					


					
					console.log(e); // TODO REMOVE DEBUG LOG
					console.log(_button); // TODO REMOVE DEBUG LOG
					console.log(_button.dataset); // TODO REMOVE DEBUG LOG
					console.log(_view.selectedEngine); // TODO REMOVE DEBUG LOG
					
					
					switch (_selectedEngine.type) {
					
						case 'sensor':
							_ngnList = _view.sensors;
							break;
							
						case 'actuator':
							_ngnList = _view.actuators;
							break;
							
						default:
							break;
					}
					
					
					if (_ngnList === null) {
						return;
					}
					
					var _searchEngine = _consoleApp.engines.NGN_Manager.getEngineByID({
						"engineID": _selectedEngine.engineid,
						"list": _ngnList
						});


					if (_searchEngine.engine === null) {
						return;
					}
					
					_selectedEngine.engine = _searchEngine.engine;
					
					/*
					_engineOptions_Dialog.open();
					
					// Notification required for binding to update!
			        _view.notifyPath('selectedEngine.type', _view.selectedEngine.type);
			        _view.notifyPath('selectedEngine.engine', _view.selectedEngine.engine);
			        */
			        
					_view.async(function(){
						_engineOptions_Dialog.open();
					}, 167);
					
					_view.async(function(){
						// Notification required for binding to update!
				        _view.notifyPath('selectedEngine.type', _view.selectedEngine.type);
				        _view.notifyPath('selectedEngine.engine', _view.selectedEngine.engine);
					}, 267);
					
					
				},	// endOf _engineSettings
				
				
				_getEngineOptions: function(e, detail) {
					
					console.log("_getEngineOptions"); // TODO REMOVE DEBUG LOG
					
					var _view = this;
					var _selectedEngine = _view.get('selectedEngine');
					var _consoleApp = st_ConsoleApp.get_ConsoleApp();
					
					var _engineOptions_Dialog = _view.$.engineOptions_Dialog;
					var _toast_Error = _view.$.toast_Error;
					var _toast_OK = _view.$.toast_OK;
					
					var _scs_Request = null;
					var _scs_RequestOptions = null;
					

					switch (_selectedEngine.type) {
					
						case 'sensor':
							
							_scs_Request = st_ConsoleApp.engines.sensors.get_SensorOptions;
							_scs_RequestOptions = {
									"consoleApp" : _consoleApp,
									"sensorID": _selectedEngine.engine._sysID
								};
							
							
							
							break;
							
						case 'actuator':
							
							_scs_Request = st_ConsoleApp.engines.actuators.get_ActuatorOptions;
							_scs_RequestOptions = {
									"consoleApp" : _consoleApp,
									"actuatorID": _selectedEngine.engine._sysID
								};
							break;
							
						default:
							break;
					}
					
					if (_scs_Request === null) {
						return;
					}
					
					try {

						_scs_Request(_scs_RequestOptions)
								.then(function(data) {

									console.log("st-view-EnginesList._getEngineOptions - then..."); // TODO REMOVE DEBUG LOG
									console.log(data); // TODO REMOVE DEBUG LOG

									// 	_view.actuators = data.actuators;

									// Show toast message
									_toast_OK.close();
									_view.toast_Message = "Engine options received...";
									_toast_OK.fitInto = _engineOptions_Dialog;
									_toast_OK.open();

								},
								function(error) {
	
									// Show toast message
									_toast_OK.close();
									_view.toast_ErrorMessage = "Cannot get Engine options";
									_toast_Error.fitInto = _engineOptions_Dialog;
									_toast_Error.open();
	
									console.log("st-view-EnginesList._getEngineOptions - error..."); // TODO REMOVE DEBUG LOG
									console.log(error); // TODO REMOVE DEBUG LOG
								});

					} catch (e) {
						// TODO: handle exception
						console.log("Error in Engine options"); // TODO REMOVE DEBUG LOG
						console.log(e); // TODO REMOVE DEBUG LOG
					}
					
					
				},	// endOf _getEngineOptions
				
				
				_engineDetail: function(options){
					
					var _view = this;
					var _consoleApp = st_ConsoleApp.get_ConsoleApp();
					
					var _type = options.type;
					var _engineID = options.engineID;
					var _model = options.model;
					
					var _scs_Request = null;
					var _scs_RequestOptions = null;
					var _ngnList = null;
					var _ngnListView = null;
					
					
					switch (_type) {
					
						case 'sensor':
							
							_scs_Request = st_ConsoleApp.engines.sensors.get_SensorInfo;
							_scs_RequestOptions = {
								"consoleApp" : _consoleApp,
								"sensorID": _engineID
							};
						
							_ngnListView = _view.$.listForSensors;
							_ngnListViewStr = 'listForSensors';
							_ngnList = _view.sensors;
							// _notifyPath = 'listForSensors.items';
							_notifyPath = 'sensors';
							
							break;
							
						case 'actuator':
							
							_scs_Request = st_ConsoleApp.engines.actuators.get_ActuatorInfo;
							_scs_RequestOptions = {
								"consoleApp" : _consoleApp,
								"actuatorID": _engineID
							};
							
							_ngnListView = _view.$.listForActuators;
							_ngnListViewStr = 'listForActuators';
							_ngnList = _view.actuators;
							// _notifyPath = 'listForActuators.items';
							_notifyPath = 'actuators';
							
							break;
	
						default:
							break;
					}
					
					if (_scs_Request === null) {
						return;
					}
					
					var _searchEngine = _consoleApp.engines.NGN_Manager.getEngineByID({
						"engineID": _engineID,
						"list": _ngnList
						});


					if (_searchEngine.engine === null) {
						return;
					}
					
					
					try {

						_scs_Request( _scs_RequestOptions )
								.then(function(data) {

									console.log("st-view-EnginesList._engineDetail - then..."); // TODO REMOVE DEBUG LOG
									console.log(data); // TODO REMOVE DEBUG LOG
									
									switch (_type) {
										case 'sensor':
											
											_ngnList.splice(_searchEngine.position, 1, data.sensor);
											_ngnList = _ngnList.slice();
											break;
											
										case 'actuator':
											_ngnList.splice(_searchEngine.position, 1, data.actuator);
											_ngnList = _ngnList.slice();
											
											break;
	
										default:
											break;
									}
									
									
									
									// Notify DOM change
									
									_view.async(function(){
										_view.notifyPath(
												_notifyPath, 
												_ngnList);
									}, 267);
									
									_view.async(function(){
										_ngnListView.selectItem(_searchEngine.position);
										_ngnListView.fire('iron-resize');
									}, 367);
									
									

								},
								function(error) {
	
									console.log("st-view-EnginesList._engineDetail - error..."); // TODO REMOVE DEBUG LOG
									console.log(error); // TODO REMOVE DEBUG LOG
								});

					} catch (e) {
						// TODO: handle exception
						console.log("Error in Engine detail"); // TODO REMOVE DEBUG LOG
						console.log(e); // TODO REMOVE DEBUG LOG
					}
					
					
				},	// endOf _engineDetail
				
				
				_engineRun: function(e, detail) {
					
					console.log("_engineRun"); // TODO REMOVE DEBUG LOG
					
					var _view = this;
					var _consoleApp = st_ConsoleApp.get_ConsoleApp();
					var _toast_Error = _view.$.toast_Error;
					var _toast_OK = _view.$.toast_OK;
					
					var _model = e.model;
					var _button = Polymer.dom(e).localTarget;
					var _buttonDataSet = _button.dataset;
					
					var _type = _buttonDataSet.type;
					var _command = _buttonDataSet.command;
					var _engineID = _buttonDataSet.engineid;
					
					var _scs_Request = null;
					var _scs_RequestOptions = null;
					var _enginesList = null;
					var _notifyPath = null;
					
					console.log(e.model); // TODO REMOVE DEBUG LOG

					switch (_type) {
					
						case 'sensor':	// Sensor engine
							
							_scs_RequestOptions = {
								"consoleApp" : _consoleApp,
								"sensorID": _engineID
							};
						
							_enginesList = _view.$.listForSensors.items;
							_notifyPath = 'listForSensors.list';
							
							switch (_command) {
								case 'start':
									_scs_Request = st_ConsoleApp.engines.sensors.start_Sensor;
									break;
	
								case 'stop':
									_scs_Request = st_ConsoleApp.engines.sensors.stop_Sensor;
									break;
									
								default:
									break;
							}
							
							break;
							
							
						case 'actuator':	// Actuator engine
						
							_scs_RequestOptions = {
								"consoleApp" : _consoleApp,
								"actuatorID": _engineID
							};
						
							_enginesList = _view.$.listForActuators.items;
							_notifyPath = 'listForActuators.list';
							
							switch (_command) {
								case 'start':
									_scs_Request = st_ConsoleApp.engines.actuators.start_Actuator;
									break;
	
								case 'stop':
									_scs_Request = st_ConsoleApp.engines.actuators.stop_Actuator;
									break;
									
								default:
									break;
							}
							
							break;
							
						default:
							break;
					}
					
					
					
					if (_scs_Request === null) {
						return;
					}
					
					
					var _searchEngine = _consoleApp.engines.NGN_Manager.getEngineByID({
												"engineID": _engineID,
												"list": _enginesList
												});
					
					
					if (_searchEngine.engine === null) {
						return;
					}
					
					
					try {

						_scs_Request( _scs_RequestOptions )
								.then(function(data) {

									console.log("st-view-EnginesList._engineRun - then..."); // TODO REMOVE DEBUG LOG
									console.log(data); // TODO REMOVE DEBUG LOG
									
									// Show toast message
									_toast_OK.close();
									_view.toast_Message = "Engine command (" + _command +  ") transmited.";
									_toast_OK.fitInto = Polymer.dom(_button).parentNode;
									// _toast_OK.fitInto = _refButton;
									_toast_OK.open();
									
									
									// Get detail of Engine (500ms later)
									
									_view.async(function(){
										_view._engineDetail({
											"type": _type,
											"engineID": _engineID,
											"list": _enginesList,
											"model": _model
										});
									}, 436);

								},
								function(error) {
	
									// Show toast message
									_toast_OK.close();
									_view.toast_ErrorMessage = "Error in Engine command: (" + _command +  ")";
									_toast_OK.fitInto = Polymer.dom(_button).parentNode;
									// _toast_OK.fitInto = _refButton;
									_toast_OK.open();
	
									console.log("st-view-EnginesList._engineRun - error..."); // TODO REMOVE DEBUG LOG
									console.log(error); // TODO REMOVE DEBUG LOG
								});

					} catch (e) {
						// TODO: handle exception
						console.log("Error in Engine Run"); // TODO REMOVE DEBUG LOG
						console.log(e); // TODO REMOVE DEBUG LOG
					}
					
				},	// endOf _engineRun

			});
		</script>

</dom-module>
